<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section - 4 Visualization üìâ | CryptoResearchPaper.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Section - 4 Visualization üìâ | CryptoResearchPaper.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section - 4 Visualization üìâ | CryptoResearchPaper.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-prep.html"/>
<link rel="next" href="predictive-modeling.html"/>
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.13/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Cryptocurrency Research</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>1</b> Setup and Installation</a>
<ul>
<li class="chapter" data-level="1.1" data-path="setup.html"><a href="setup.html#option-1---run-in-the-cloud"><i class="fa fa-check"></i><b>1.1</b> Option 1 - Run in the Cloud</a></li>
<li class="chapter" data-level="1.2" data-path="setup.html"><a href="setup.html#option-2---run-locally"><i class="fa fa-check"></i><b>1.2</b> Option 2 - Run Locally</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="setup.html"><a href="setup.html#setup-r"><i class="fa fa-check"></i><b>1.2.1</b> Setup R</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="setup.html"><a href="setup.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>1.3</b> Installing and Loading Packages</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="explore-data.html"><a href="explore-data.html"><i class="fa fa-check"></i><b>2</b> Explore the Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="explore-data.html"><a href="explore-data.html#pull-the-data"><i class="fa fa-check"></i><b>2.1</b> Pull the Data</a></li>
<li class="chapter" data-level="2.2" data-path="explore-data.html"><a href="explore-data.html#data-preview"><i class="fa fa-check"></i><b>2.2</b> Data Preview</a></li>
<li class="chapter" data-level="2.3" data-path="explore-data.html"><a href="explore-data.html#the-definition-of-a-price"><i class="fa fa-check"></i><b>2.3</b> The definition of a ‚Äúprice‚Äù</a></li>
<li class="chapter" data-level="2.4" data-path="explore-data.html"><a href="explore-data.html#data-quality"><i class="fa fa-check"></i><b>2.4</b> Data Quality</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>3</b> Data Prep</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-prep.html"><a href="data-prep.html#remove-nulls"><i class="fa fa-check"></i><b>3.1</b> Remove Nulls</a></li>
<li class="chapter" data-level="3.2" data-path="data-prep.html"><a href="data-prep.html#calculate-price_usd-column"><i class="fa fa-check"></i><b>3.2</b> Calculate <code>price_usd</code> Column</a></li>
<li class="chapter" data-level="3.3" data-path="data-prep.html"><a href="data-prep.html#any-gaps"><i class="fa fa-check"></i><b>3.3</b> Any gaps?</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-prep.html"><a href="data-prep.html#convert-to-tsibble"><i class="fa fa-check"></i><b>3.3.1</b> Convert to tsibble</a></li>
<li class="chapter" data-level="3.3.2" data-path="data-prep.html"><a href="data-prep.html#scan-gaps"><i class="fa fa-check"></i><b>3.3.2</b> Scan gaps</a></li>
<li class="chapter" data-level="3.3.3" data-path="data-prep.html"><a href="data-prep.html#fill-gaps"><i class="fa fa-check"></i><b>3.3.3</b> Fill gaps</a></li>
<li class="chapter" data-level="3.3.4" data-path="data-prep.html"><a href="data-prep.html#group-data"><i class="fa fa-check"></i><b>3.3.4</b> Group Data</a></li>
<li class="chapter" data-level="3.3.5" data-path="data-prep.html"><a href="data-prep.html#calculate-target"><i class="fa fa-check"></i><b>3.3.5</b> Calculate Target</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-prep.html"><a href="data-prep.html#remove-subsets-without-enough-rows"><i class="fa fa-check"></i><b>3.4</b> Remove subsets without enough rows</a></li>
<li class="chapter" data-level="3.5" data-path="data-prep.html"><a href="data-prep.html#cross-validation"><i class="fa fa-check"></i><b>3.5</b> Cross Validation</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-prep.html"><a href="data-prep.html#fix-data-by-split"><i class="fa fa-check"></i><b>3.5.1</b> Fix Data by Split</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-prep.html"><a href="data-prep.html#nest-data"><i class="fa fa-check"></i><b>3.6</b> Nest data</a></li>
<li class="chapter" data-level="3.7" data-path="data-prep.html"><a href="data-prep.html#functional-programming"><i class="fa fa-check"></i><b>3.7</b> Functional Programming</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>4</b> Visualization üìâ</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualization.html"><a href="visualization.html#basics---ggplot2"><i class="fa fa-check"></i><b>4.1</b> Basics - ggplot2</a></li>
<li class="chapter" data-level="4.2" data-path="visualization.html"><a href="visualization.html#using-extensions"><i class="fa fa-check"></i><b>4.2</b> Using Extensions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualization.html"><a href="visualization.html#ggthemes"><i class="fa fa-check"></i><b>4.2.1</b> ggthemes</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualization.html"><a href="visualization.html#plotly"><i class="fa fa-check"></i><b>4.2.2</b> plotly</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualization.html"><a href="visualization.html#gganimate"><i class="fa fa-check"></i><b>4.2.3</b> gganimate</a></li>
<li class="chapter" data-level="4.2.4" data-path="visualization.html"><a href="visualization.html#calendar-heatmap"><i class="fa fa-check"></i><b>4.2.4</b> Calendar Heatmap</a></li>
<li class="chapter" data-level="4.2.5" data-path="visualization.html"><a href="visualization.html#rayshader"><i class="fa fa-check"></i><b>4.2.5</b> Rayshader</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="predictive-modeling.html"><a href="predictive-modeling.html"><i class="fa fa-check"></i><b>5</b> Predictive Modeling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#example-simple-model"><i class="fa fa-check"></i><b>5.1</b> Example Simple Model</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#using-functional-programming"><i class="fa fa-check"></i><b>5.1.1</b> Using Functional Programming</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#caret"><i class="fa fa-check"></i><b>5.2</b> Caret</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#parallel-processing"><i class="fa fa-check"></i><b>5.2.1</b> Parallel Processing</a></li>
<li class="chapter" data-level="5.2.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#functional-programming---here-or-elsewhere"><i class="fa fa-check"></i><b>5.2.2</b> Functional Programming - here or elsewhere?</a></li>
<li class="chapter" data-level="5.2.3" data-path="predictive-modeling.html"><a href="predictive-modeling.html#cross-validation-1"><i class="fa fa-check"></i><b>5.2.3</b> Cross Validation</a></li>
<li class="chapter" data-level="5.2.4" data-path="predictive-modeling.html"><a href="predictive-modeling.html#xgboost-models"><i class="fa fa-check"></i><b>5.2.4</b> XGBoost models</a></li>
<li class="chapter" data-level="5.2.5" data-path="predictive-modeling.html"><a href="predictive-modeling.html#all-other-models"><i class="fa fa-check"></i><b>5.2.5</b> All Other Models</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="predictive-modeling.html"><a href="predictive-modeling.html#make-predictions"><i class="fa fa-check"></i><b>5.3</b> Make Predictions</a></li>
<li class="chapter" data-level="5.4" data-path="predictive-modeling.html"><a href="predictive-modeling.html#traditional-timeseries"><i class="fa fa-check"></i><b>5.4</b> Traditional Timeseries</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html"><i class="fa fa-check"></i><b>6</b> Evaluate Model Performance</a>
<ul>
<li class="chapter" data-level="6.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#summarizing-models"><i class="fa fa-check"></i><b>6.1</b> Summarizing models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#adjust-rmse"><i class="fa fa-check"></i><b>6.1.1</b> Adjust RMSE</a></li>
<li class="chapter" data-level="6.1.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#calculate-rmse"><i class="fa fa-check"></i><b>6.1.2</b> Calculate RMSE</a></li>
<li class="chapter" data-level="6.1.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#calculate-r2"><i class="fa fa-check"></i><b>6.1.3</b> Calculate R^2</a></li>
<li class="chapter" data-level="6.1.4" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#new-section"><i class="fa fa-check"></i><b>6.1.4</b> New Section</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#visualize-results"><i class="fa fa-check"></i><b>6.2</b> Visualize Results</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#rmse-visualization"><i class="fa fa-check"></i><b>6.2.1</b> RMSE Visualization</a></li>
<li class="chapter" data-level="6.2.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#both"><i class="fa fa-check"></i><b>6.2.2</b> Both</a></li>
<li class="chapter" data-level="6.2.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#results-by-the-cryptocurrency"><i class="fa fa-check"></i><b>6.2.3</b> Results by the Cryptocurrency</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>7</b> Time Series</a></li>
<li class="chapter" data-level="8" data-path="explain-predictions.html"><a href="explain-predictions.html"><i class="fa fa-check"></i><b>8</b> Explain Predictions</a></li>
<li class="chapter" data-level="9" data-path="considerations.html"><a href="considerations.html"><i class="fa fa-check"></i><b>9</b> Considerations</a>
<ul>
<li class="chapter" data-level="9.1" data-path="considerations.html"><a href="considerations.html#session-information"><i class="fa fa-check"></i><b>9.1</b> Session Information</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="archive.html"><a href="archive.html"><i class="fa fa-check"></i><b>10</b> Archive</a>
<ul>
<li class="chapter" data-level="10.1" data-path="archive.html"><a href="archive.html#may-2020"><i class="fa fa-check"></i><b>10.1</b> May 2020</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a>
<ul>
<li class="chapter" data-level="11.1" data-path="references.html"><a href="references.html#resources-used"><i class="fa fa-check"></i><b>11.1</b> Resources Used</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="references.html"><a href="references.html#visualization-section"><i class="fa fa-check"></i><b>11.1.1</b> Visualization Section</a></li>
<li class="chapter" data-level="11.1.2" data-path="references.html"><a href="references.html#time-series-section"><i class="fa fa-check"></i><b>11.1.2</b> Time Series Section</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="references.html"><a href="references.html#packages-used-and-cited"><i class="fa fa-check"></i><b>11.2</b> Packages used and cited</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualization" class="section level1" number="4">
<h1><span class="header-section-number">Section - 4</span> Visualization üìâ</h1>
<!-- NOTE 09/27: REVAMP THIS SECTION, ANSWER QUESTIONS ABOUT THE DATA MORE -->
<!-- NOTE 05/24: I'm thinking should calculate % change just for visualization purposes just here, but what if we avoid that completely and instead make the tutorial on visualizing price over time for BTC first and then creating gganimate tutorial to iterate over the rest? Just keep it to ggplot2 + extensions + gganimate tutorial here, no need to make a million visualizations. Would be good to add rayshader too, but add that as a stretch goal for later. -->
<p>Making visualizations using <code>ggplot2</code> is one of the very best tools available in the R ecosystem. The <strong><em>gg</em></strong> in <code>ggplot2</code> stands for the <strong><em>Grammar of Graphics</em></strong>, which is essentially the idea that many different types of charts share the same underlying building blocks, and that they can be put together in different ways to make charts that look very different from each other. <a href="https://qz.com/1007328/all-hail-ggplot2-the-code-powering-all-those-excellent-charts-is-10-years-old/">In Hadley‚Äôs own words,</a> ‚Äúa pie chart is just a bar chart drawn in polar coordinates‚Äù, ‚ÄúThey look very different, but in terms of the grammar they have a lot of underlying similarities.‚Äù</p>
<div id="basics---ggplot2" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Basics - ggplot2</h2>
<p>So how does <code>ggplot2</code> actually work? <strong><em>‚Äú‚Ä¶in most cases you start with <code>ggplot()</code>, supply a dataset and aesthetic mapping (with <code>aes()</code>). You then add on layers (like <code>geom_point()</code> or <code>geom_histogram()</code>), scales (like <code>scale_colour_brewer()</code>), faceting specifications (like <code>facet_wrap()</code>) and coordinate systems (like <code>coord_flip()</code>).‚Äù</em></strong> - <a href="https://ggplot2.tidyverse.org/">ggplot2.tidyverse.org/</a>.</p>
<p>Let‚Äôs break this down step by step.</p>
<p><strong><em>"start with ggplot(), supply a dataset and aesthetic mapping (with aes())</em></strong></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="visualization.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cryptodata, <span class="fu">aes</span>(<span class="at">x =</span> date_time_utc, <span class="at">y =</span> price_usd))</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/ggplot_blank-1.png" width="672" /></p>
<p>The chart now shows up but is blank because we need to perform an additional step <strong><em>‚ÄúYou then add on layers (like <code>geom_point()</code> or <code>geom_histogram()</code>)‚Ä¶‚Äù</em></strong></p>
<p>We can take the exact same code as above and add <strong><em>+ <code>geom_point()</code></em></strong></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="visualization.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> cryptodata, <span class="fu">aes</span>(<span class="at">x =</span> date_time_utc, <span class="at">y =</span> price_usd)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="visualization.html#cb60-2" aria-hidden="true" tabindex="-1"></a>       <span class="co"># adding geom_point():</span></span>
<span id="cb60-3"><a href="visualization.html#cb60-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/ggplot_geom_point-1.png" width="672" /></p>
<p>The most expensive cryptocurrency being shown, BTC in this case, makes it difficult to take a look at any of the other ones. Let‚Äôs try <em>zooming-in</em> on a single one by using the same code but making an adjustment to the <code>data</code> parameter to only show data for the cryptocurrency with the symbol <em>ETH</em>, first let‚Äôs filter the data down to those results only:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="visualization.html#cb61-1" aria-hidden="true" tabindex="-1"></a>eth_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(cryptodata, symbol <span class="sc">==</span> <span class="st">&#39;ETH&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="visualization.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> eth_data, </span>
<span id="cb62-2"><a href="visualization.html#cb62-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> date_time_utc, <span class="at">y =</span> price_usd)) <span class="sc">+</span> </span>
<span id="cb62-3"><a href="visualization.html#cb62-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/ggplot_ETH-1.png" width="672" /></p>
<p><em>The axis automatically adjusted to the new data.</em></p>
<p>This is better, but geom_point() might not be the best choice for this chart, let‚Äôs change <code>geom_point</code> with <code>geom_line</code> and see what that looks like:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="visualization.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> eth_data, </span>
<span id="cb63-2"><a href="visualization.html#cb63-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> date_time_utc, <span class="at">y =</span> price_usd)) <span class="sc">+</span> </span>
<span id="cb63-3"><a href="visualization.html#cb63-3" aria-hidden="true" tabindex="-1"></a>       <span class="co"># changing geom_point() into geom_line():</span></span>
<span id="cb63-4"><a href="visualization.html#cb63-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/ggplot_ETH_line-1.png" width="672" /></p>
<p>Let‚Äôs save the results as an object called <code>crypto_chart</code>:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="visualization.html#cb64-1" aria-hidden="true" tabindex="-1"></a>crypto_chart <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> eth_data, </span>
<span id="cb64-2"><a href="visualization.html#cb64-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">x =</span> date_time_utc, <span class="at">y =</span> price_usd)) <span class="sc">+</span> </span>
<span id="cb64-3"><a href="visualization.html#cb64-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">geom_line</span>()</span></code></pre></div>
<p>We can add a linear regression line going through the plot to show the strength of the relationship between the two values. A horizontal line would show a weak relationship, while a sloped line would show a strong one.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="visualization.html#cb65-1" aria-hidden="true" tabindex="-1"></a>crypto_chart <span class="ot">&lt;-</span> crypto_chart <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&#39;lm&#39;</span>)</span>
<span id="cb65-2"><a href="visualization.html#cb65-2" aria-hidden="true" tabindex="-1"></a>crypto_chart</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="CryptoResearchPaper_files/figure-html/ggplot_ETH_lm_relationship-1.png" width="672" /></p>
<p>Next, let‚Äôs adjust the labels on the chart:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="visualization.html#cb67-1" aria-hidden="true" tabindex="-1"></a>crypto_chart <span class="ot">&lt;-</span> crypto_chart <span class="sc">+</span></span>
<span id="cb67-2"><a href="visualization.html#cb67-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ggtitle</span>(<span class="st">&#39;Previous 24h % Price Change Vs. Next 24h Price % Change&#39;</span>, </span>
<span id="cb67-3"><a href="visualization.html#cb67-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">subtitle =</span> <span class="fu">max</span>(eth_data<span class="sc">$</span>symbol)) <span class="sc">+</span> </span>
<span id="cb67-4"><a href="visualization.html#cb67-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">xlab</span>(<span class="st">&#39;Previous 24 hours % Price Change&#39;</span>) <span class="sc">+</span></span>
<span id="cb67-5"><a href="visualization.html#cb67-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ylab</span>(<span class="st">&#39;Next 24 hours % Price Change&#39;</span>)</span>
<span id="cb67-6"><a href="visualization.html#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># display the new chart</span></span>
<span id="cb67-7"><a href="visualization.html#cb67-7" aria-hidden="true" tabindex="-1"></a>crypto_chart</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="CryptoResearchPaper_files/figure-html/ggplot_labels-1.png" width="672" /></p>
</div>
<div id="using-extensions" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Using Extensions</h2>
<div id="ggthemes" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> ggthemes</h3>
<p>Let‚Äôs import a <code>ggplot2</code> <strong><em>‚Äúextension‚Äù</em></strong> by importing a package called <code>ggthemes</code> <span class="citation">[@R-ggthemes]</span> and apply a theme to change the overall look of the chart:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="visualization.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the theme &quot;economist&quot;</span></span>
<span id="cb69-2"><a href="visualization.html#cb69-2" aria-hidden="true" tabindex="-1"></a>crypto_chart <span class="ot">&lt;-</span> crypto_chart <span class="sc">+</span> <span class="fu">theme_economist</span>()</span>
<span id="cb69-3"><a href="visualization.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># display the new chart</span></span>
<span id="cb69-4"><a href="visualization.html#cb69-4" aria-hidden="true" tabindex="-1"></a>crypto_chart</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/ggthemes-1.png" width="672" /></p>
<p><em>You can find a full list of themes here: <a href="https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/" class="uri">https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/</a></em></p>
</div>
<div id="plotly" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> plotly</h3>
<p>In some cases, it‚Äôs helpful to make a chart responsive to a cursor hovering over it. We can convert any ggplot into an interactive chart by using the <code>plotly</code> <span class="citation">[@R-plotly]</span> package:</p>
<!-- CAUSES ISSUES 06/11 -->
<!-- ```{r plotly, message=FALSE, warning=FALSE} -->
<!-- library(plotly) -->
<!-- # wrap any ggplot in the function ggplotly() to make it interactive -->
<!-- ggplotly(crypto_chart) -->
<!-- # notice that we did not overwrite the crypto_chart object this time -->
<!-- ``` -->
<p>If you are not looking to convert a ggplot, plotly also provides its own framework for making charts available in R, you can find out more about it here: <a href="https://plotly.com/r/" class="uri">https://plotly.com/r/</a></p>
<!-- ```{r show_plotly_website, echo=F} -->
<!-- knitr::include_url("https://plotly.com/r/", -->
<!--   height = "600px") -->
<!-- ``` -->
<!-- ***https://plotly.com/r/*** -->
<!-- NOT WORKING ANYMORE ON 10/21/2020: -->
<!-- ### ggpubr -->
<!-- We can use another extension called `ggpubr` [@R-ggpubr] and show the regression formula itself as well as correlation metrics (R-squared and p-value) on the chart. -->
<!-- ```{r ggpubr, message=FALSE, warning=FALSE} -->
<!-- library(ggpubr) -->
<!-- # use the custom imported functions stat_cor() and stat_regline_equation() -->
<!-- crypto_chart <- crypto_chart + -->
<!--                   stat_cor(label.x = -30, label.y = 25) + -->
<!--                   stat_regline_equation(label.x = -30, label.y = 20) + -->
<!--                   xlim(c(-35,35)) + ylim(c(-35,35)) -->
<!-- # display the new chart -->
<!-- crypto_chart -->
<!-- ``` -->
<!-- ### ggforce (NOT WORKING! ERROR, NOT SURE WHAT CHANGED) -->
<!-- The `ggforce` package [@R-ggforce] is a useful tool for annotating charts. We can annotate outliers for example: -->
<!-- ```{r add_ggforce_annotations} -->
<!-- library(ggforce) -->
<!-- crypto_chart <- crypto_chart +  -->
<!--                   geom_mark_ellipse(aes(filter = volume_last_24_hours == max(volume_last_24_hours), -->
<!--                                         label = date_extracted , -->
<!--                                         description=paste0('Price spike to $',price_usd))) + -->
<!--                   geom_mark_ellipse(aes(filter = volume_last_24_hours == min(volume_last_24_hours), -->
<!--                                         label = date_extracted , -->
<!--                                         description=paste0('Price drop to $',price_usd)))  -->
<!-- ``` -->
<!-- ```{r} -->
<!-- crypto_chart -->
<!-- ``` -->
</div>
<div id="gganimate" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> gganimate</h3>
<!-- LOOK THROUGH THIS AND PUT THE PRICE OVER TIME CHART AND THE RELATIONSHIP BETWEEN PREVIOUS PRICE AND NEXT 24H PRICE SIDE BY SIDE, AND HAVE THEM ANIMATED ITERATING OVER ALL CRYPTOCURRENCIES: https://github.com/thomasp85/gganimate/wiki/Animation-Composition -->
<!-- DISABLED CODE BELOW BECAUSE OF AN ERROR "trasnformr is required to tween paths and lines" -->
<p>We can repeat the same steps on the complete dataset, and then animate the results for each of the groups. Here is the first chart again, animated based on the groupings we created in the previous section:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="visualization.html#cb70-1" aria-hidden="true" tabindex="-1"></a>animated_prices <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">mutate</span>(cryptodata, <span class="at">groups=</span>symbol),</span>
<span id="cb70-2"><a href="visualization.html#cb70-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> date_time_utc, <span class="at">y =</span> price_usd)) <span class="sc">+</span></span>
<span id="cb70-3"><a href="visualization.html#cb70-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb70-4"><a href="visualization.html#cb70-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">transition_states</span>(groups) <span class="sc">+</span></span>
<span id="cb70-5"><a href="visualization.html#cb70-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ggtitle</span>(<span class="st">&#39;Price Over Time&#39;</span>,<span class="at">subtitle =</span> <span class="st">&#39;{closest_state}&#39;</span>) <span class="sc">+</span></span>
<span id="cb70-6"><a href="visualization.html#cb70-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">view_follow</span>() <span class="co"># this adjusts the axis based on the group</span></span>
<span id="cb70-7"><a href="visualization.html#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Show animation:</span></span>
<span id="cb70-8"><a href="visualization.html#cb70-8" aria-hidden="true" tabindex="-1"></a>animated_prices</span></code></pre></div>
<pre><code>## 
Frame 1 (1%)
Frame 2 (2%)
Frame 3 (3%)
Frame 4 (4%)
Frame 5 (5%)
Frame 6 (6%)
Frame 7 (7%)
Frame 8 (8%)
Frame 9 (9%)
Frame 10 (10%)
Frame 11 (11%)
Frame 12 (12%)
Frame 13 (13%)
Frame 14 (14%)
Frame 15 (15%)
Frame 16 (16%)
Frame 17 (17%)
Frame 18 (18%)
Frame 19 (19%)
Frame 20 (20%)
Frame 21 (21%)
Frame 22 (22%)
Frame 23 (23%)
Frame 24 (24%)
Frame 25 (25%)
Frame 26 (26%)
Frame 27 (27%)
Frame 28 (28%)
Frame 29 (29%)
Frame 30 (30%)
Frame 31 (31%)
Frame 32 (32%)
Frame 33 (33%)
Frame 34 (34%)
Frame 35 (35%)
Frame 36 (36%)
Frame 37 (37%)
Frame 38 (38%)
Frame 39 (39%)
Frame 40 (40%)
Frame 41 (41%)
Frame 42 (42%)
Frame 43 (43%)
Frame 44 (44%)
Frame 45 (45%)
Frame 46 (46%)
Frame 47 (47%)
Frame 48 (48%)
Frame 49 (49%)
Frame 50 (50%)
Frame 51 (51%)
Frame 52 (52%)
Frame 53 (53%)
Frame 54 (54%)
Frame 55 (55%)
Frame 56 (56%)
Frame 57 (57%)
Frame 58 (58%)
Frame 59 (59%)
Frame 60 (60%)
Frame 61 (61%)
Frame 62 (62%)
Frame 63 (63%)
Frame 64 (64%)
Frame 65 (65%)
Frame 66 (66%)
Frame 67 (67%)
Frame 68 (68%)
Frame 69 (69%)
Frame 70 (70%)
Frame 71 (71%)
Frame 72 (72%)
Frame 73 (73%)
Frame 74 (74%)
Frame 75 (75%)
Frame 76 (76%)
Frame 77 (77%)
Frame 78 (78%)
Frame 79 (79%)
Frame 80 (80%)
Frame 81 (81%)
Frame 82 (82%)
Frame 83 (83%)
Frame 84 (84%)
Frame 85 (85%)
Frame 86 (86%)
Frame 87 (87%)
Frame 88 (88%)
Frame 89 (89%)
Frame 90 (90%)
Frame 91 (91%)
Frame 92 (92%)
Frame 93 (93%)
Frame 94 (94%)
Frame 95 (95%)
Frame 96 (96%)
Frame 97 (97%)
Frame 98 (98%)
Frame 99 (99%)
Frame 100 (100%)
## Finalizing encoding... done!</code></pre>
<p><img src="CryptoResearchPaper_files/figure-html/first_gganimate-1.gif" /><!-- --></p>
<p>We can slow down the animation by using <code>animate()</code> and choosing the speed in terms of the frames per second (<code>fps</code>)"</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="visualization.html#cb72-1" aria-hidden="true" tabindex="-1"></a>animated_prices_result <span class="ot">&lt;-</span> <span class="fu">animate</span>(animated_prices,<span class="at">fps=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
Frame 1 (1%)
Frame 2 (2%)
Frame 3 (3%)
Frame 4 (4%)
Frame 5 (5%)
Frame 6 (6%)
Frame 7 (7%)
Frame 8 (8%)
Frame 9 (9%)
Frame 10 (10%)
Frame 11 (11%)
Frame 12 (12%)
Frame 13 (13%)
Frame 14 (14%)
Frame 15 (15%)
Frame 16 (16%)
Frame 17 (17%)
Frame 18 (18%)
Frame 19 (19%)
Frame 20 (20%)
Frame 21 (21%)
Frame 22 (22%)
Frame 23 (23%)
Frame 24 (24%)
Frame 25 (25%)
Frame 26 (26%)
Frame 27 (27%)
Frame 28 (28%)
Frame 29 (29%)
Frame 30 (30%)
Frame 31 (31%)
Frame 32 (32%)
Frame 33 (33%)
Frame 34 (34%)
Frame 35 (35%)
Frame 36 (36%)
Frame 37 (37%)
Frame 38 (38%)
Frame 39 (39%)
Frame 40 (40%)
Frame 41 (41%)
Frame 42 (42%)
Frame 43 (43%)
Frame 44 (44%)
Frame 45 (45%)
Frame 46 (46%)
Frame 47 (47%)
Frame 48 (48%)
Frame 49 (49%)
Frame 50 (50%)
Frame 51 (51%)
Frame 52 (52%)
Frame 53 (53%)
Frame 54 (54%)
Frame 55 (55%)
Frame 56 (56%)
Frame 57 (57%)
Frame 58 (58%)
Frame 59 (59%)
Frame 60 (60%)
Frame 61 (61%)
Frame 62 (62%)
Frame 63 (63%)
Frame 64 (64%)
Frame 65 (65%)
Frame 66 (66%)
Frame 67 (67%)
Frame 68 (68%)
Frame 69 (69%)
Frame 70 (70%)
Frame 71 (71%)
Frame 72 (72%)
Frame 73 (73%)
Frame 74 (74%)
Frame 75 (75%)
Frame 76 (76%)
Frame 77 (77%)
Frame 78 (78%)
Frame 79 (79%)
Frame 80 (80%)
Frame 81 (81%)
Frame 82 (82%)
Frame 83 (83%)
Frame 84 (84%)
Frame 85 (85%)
Frame 86 (86%)
Frame 87 (87%)
Frame 88 (88%)
Frame 89 (89%)
Frame 90 (90%)
Frame 91 (91%)
Frame 92 (92%)
Frame 93 (93%)
Frame 94 (94%)
Frame 95 (95%)
Frame 96 (96%)
Frame 97 (97%)
Frame 98 (98%)
Frame 99 (99%)
Frame 100 (100%)
## Finalizing encoding... done!</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="visualization.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show slowed down results</span></span>
<span id="cb74-2"><a href="visualization.html#cb74-2" aria-hidden="true" tabindex="-1"></a>animated_prices_result</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/gganimate_speed-1.gif" /><!-- --></p>
<!-- More animate options: -->
<!-- animate( -->
<!--     plot = my_plot, -->
<!--     render = gifski_renderer(), -->
<!--     height = 600, -->
<!--     width = 800,  -->
<!--     duration = 5, -->
<!--     fps = 20) -->
<!-- COMMENTED OUT BECAUSE WAS USING PRICE INSTEAD OF % CHANGE -->
<!-- ### gghiglight -->
<!-- Instead of iterating over each cryptocurrency one at a time like we did with the animation above, we might want to get a better side-by-side view of all our groups. -->
<!-- The `gghighlight` [@R-gghighlight] package lets us plot all groups on the same chart, and highlight the series we are interested in. -->
<!-- For example, we can plot the percentage change in price over a 24 hour period for all cryptocurrencies, and highlight those we are interested in to compare them against the rest of the trends. -->
<!-- ```{r gghighlight_percent_change, message=FALSE, warning=FALSE} -->
<!-- library(gghighlight) -->
<!-- ggplot(cryptodata, -->
<!--        aes(x=date_time_utc, y=((sell_price_usd_24h_later - price_usd)/price_usd) * 100, colour=symbol)) + -->
<!--   geom_line() + -->
<!--   ylab('Next 24 hours % Price Change') + -->
<!--   gghighlight(symbol=='Bitcoin') -->
<!-- ``` -->
</div>
<div id="calendar-heatmap" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Calendar Heatmap</h3>
<p>For this kind of timeseries data, another nice view we can take of the data is a calendar heatmap, by using the package <code>ggTimeSeries</code> <span class="citation">[@R-ggTimeSeries]</span>:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="visualization.html#cb75-1" aria-hidden="true" tabindex="-1"></a>calendar_heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot_calendar_heatmap</span>(eth_data,<span class="st">&#39;date_time_utc&#39;</span>,<span class="st">&#39;price_usd&#39;</span>) <span class="co">#or do target_percent_change here?</span></span>
<span id="cb75-2"><a href="visualization.html#cb75-2" aria-hidden="true" tabindex="-1"></a>calendar_heatmap</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/ggtimeseries_heatmap-1.png" width="672" /></p>
<p><em>DoW on the y-axis stands for Day Of the Week</em></p>
</div>
<div id="rayshader" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Rayshader</h3>
<p>The previous chart is helpful, but a color scale like that can be a bit difficult to interpret. Although this is mostly for fun rather than being particularly useful, we could convert the previous chart into a 3d figure that is easier to visually interpret by using the amazing <code>rayshader</code> <span class="citation">[@R-rayshader]</span> package:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="visualization.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First remove the title from the legend to avoid visual issues</span></span>
<span id="cb76-2"><a href="visualization.html#cb76-2" aria-hidden="true" tabindex="-1"></a>calendar_heatmap <span class="ot">&lt;-</span> calendar_heatmap <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span>
<span id="cb76-3"><a href="visualization.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the date to the title to make it clear these refresh twice daily</span></span>
<span id="cb76-4"><a href="visualization.html#cb76-4" aria-hidden="true" tabindex="-1"></a>calendar_heatmap <span class="ot">&lt;-</span> calendar_heatmap <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&#39;Through: &#39;</span>,<span class="fu">substr</span>(<span class="fu">max</span>(eth_data<span class="sc">$</span>date_time_utc),<span class="dv">1</span>,<span class="dv">13</span>)))</span>
<span id="cb76-5"><a href="visualization.html#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to 3d plot</span></span>
<span id="cb76-6"><a href="visualization.html#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_gg</span>(calendar_heatmap, <span class="at">zoom =</span> <span class="fl">0.60</span>, <span class="at">phi =</span> <span class="dv">35</span>, <span class="at">theta =</span> <span class="dv">45</span>)</span>
<span id="cb76-7"><a href="visualization.html#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Render snapshot</span></span>
<span id="cb76-8"><a href="visualization.html#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="fu">render_snapshot</span>(<span class="st">&#39;images/rayshader_image.png&#39;</span>)</span>
<span id="cb76-9"><a href="visualization.html#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Close RGL (which opens on plot_gg() command in a separate window)</span></span>
<span id="cb76-10"><a href="visualization.html#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rgl.close</span>()</span></code></pre></div>
<p><img src="images/rayshader_image.png" /></p>
<p>This is the same two dimensional <a href="visualization.html#calendar-heatmap">calendar heatmap that was made earlier</a>.</p>
<p>Because we can programmatically adjust the camera as shown above, that means that we can also create a snapshot, move the camera and take another one, and keep going until we have enough to make it look like a video! This is not difficult to do using the <code>render_movie()</code> function, which will take care of everything behind the scenes for the same plot as before:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="visualization.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This time let&#39;s remove the scale too since we aren&#39;t changing it:</span></span>
<span id="cb77-2"><a href="visualization.html#cb77-2" aria-hidden="true" tabindex="-1"></a>calendar_heatmap <span class="ot">&lt;-</span> calendar_heatmap <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb77-3"><a href="visualization.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Same 3d plot as before</span></span>
<span id="cb77-4"><a href="visualization.html#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_gg</span>(calendar_heatmap, <span class="at">zoom =</span> <span class="fl">0.60</span>, <span class="at">phi =</span> <span class="dv">35</span>, <span class="at">theta =</span> <span class="dv">45</span>)</span>
<span id="cb77-5"><a href="visualization.html#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Render movie</span></span>
<span id="cb77-6"><a href="visualization.html#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="fu">render_movie</span>(<span class="st">&#39;images/rayshader_video.mp4&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;C:\\Users\\Ricky\\Desktop\\Research-Paper-Example-NEW\\images\\rayshader_video.mp4&quot;</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="visualization.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Close RGL</span></span>
<span id="cb79-2"><a href="visualization.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rgl.close</span>()</span></code></pre></div>
<p><em>Click on the video below to play the output</em></p>
<p><video src="images/rayshader_video.mp4" controls=""><a href="images/rayshader_video.mp4">Video</a></video></p>
<p>Awesome! Move on to the <a href="predictive-modeling.html#predictive-modeling">next section</a> to start making predictive models for the data, or keep reading below to learn more about ggplot2 extensions.</p>
<!-- ### ggmap -->
<!-- (could probably get rid of this, cool but not super relevant) -->
<!-- There are so many different extensions for ggplot that it feels like a disservice to not be able to cover them all, so in order to show just how creative you can get, here is one last example using the `ggmap` [@R-ggmap] package. -->
<!-- ```{r import_ggmap, message=FALSE, warning=FALSE} -->
<!-- library(ggmap) -->
<!-- ``` -->
<!-- ```{r google_key, include=F} -->
<!-- register_google(gs_key) -->
<!-- ``` -->
<!-- Let's create a ggplot with the latest Google Maps satellite image of one of the towns in Russia where cryptocurrency mining facilities are prevalent. It is not easy to keep a massive facility with many powerful computers cool, so naturally very cold places like this are ideal to help keep electricity costs down. -->
<!-- ```{r show_google_map} -->
<!-- ggmap(get_map('Bratsk Russia', zoom=15, maptype='hybrid')) -->
<!-- ``` -->
<!-- We can take a slightly different view of the same location: -->
<!-- ```{r show_google_map_zoomed} -->
<!-- ggmap(get_map('Bratsk Russia', zoom=13, maptype='satellite')) -->
<!-- ``` -->
<!-- Or we could enter coordinates for a location directly instead of doing a search, here is Area 51 in Nevada for example:
<!-- ```{r}
<!-- ggmap(get_map(c(lon=-115.81, lat=37.2431), zoom=15, maptype='satellite'))
<!-- ```

If you wanted to use `ggmaps`, unfortunately this tool will require you to create your own API key through Google and connect it using `register_google()` and passing the API key to the function, before you can start returning maps. [Click here to find out more about ggmaps and getting it setup on your device, which is straightforward](https://github.com/dkahle/ggmap).

<!-- IMPORTANT: THE TUTORIAL IN THIS SECTION SHOULD MAINLY CONSIST OF GGPLOT FUNCTIONALITY, INTRODUCING EXTENSIONS, ANNOTATING CHARTS WITH GGFORCE, CREATING ANIMATIONS WITH GGANIMATE, PUTTING MULTIPLE ONES TOGETHER USING PATCHWORK.
<!-- ALSO FOCUS ON HOW DO YOU PLOT GROUPS OF DATA AS WELL AS TIMESERIES DATA, WORTH MENTIONING GGHIGHLIGHT AS WELL AS USING REGULAR FACETS, OR PLUGGING DATA INTO TRELLISCOPE.


<!-- ### Other ways to explore grouped data -->
<!-- Instead of iterating over each cryptocurrency one at a time like we did with the animation above, we might want to get a better side-by-side view of all our groups.  -->
<!-- #### gghiglight -->
<!-- The `gghighlight` [@R-gghighlight] package lets us plot all groups on the same chart, and highlight the series we are interested in.  -->
<!-- For example, we can plot the percentage change in price over a 24 hour period for all cryptocurrencies, and highlight those we are interested in to compare them against the rest of the trends. -->
<!-- ```{r gghighlight_percent_change, message=FALSE, warning=FALSE} -->
<!-- library(gghighlight) -->
<!-- ggplot(cryptodata,  -->
<!--        aes(x=date_time_utc, y=((sell_price_usd_24h_later - price_usd)/price_usd) * 100, colour=symbol)) + -->
<!--   geom_line() + -->
<!--   ylab('Next 24 hours % Price Change') + -->
<!--   gghighlight(symbol=='Bitcoin') -->
<!-- ``` -->
<!-- <!-- Rayshader here? -->
<!-- <!-- END HERE, ADD REST OF SECTIONS ABOVE: -->
<!-- ### More Extensions -->
<!-- We only scratched the surface of what is possible, and new tools are frequently developed by the community.  -->
<!-- ***You can explore the large number of ggplot2 extensions here:*** -->
<!-- ```{r show_ggplot_extensions_website, echo=F} -->
<!-- knitr::include_url("https://exts.ggplot2.tidyverse.org/gallery/", -->
<!--   height = "600px") -->
<!-- ``` -->
<!-- ***You could even write your own extensions:*** -->
<!-- ```{r show_ggplot_extensions_make_your_own, echo=F} -->
<!-- knitr::include_url("https://ggplot2-book.org/extensions.html", -->
<!--   height = "600px") -->
<!-- ``` -->
<!-- NEW CODE BELOW, DON'T DELETE: -->
<!-- For this section, let's use the object `cryptodata` instead of `crypto_grouped`, which is what will be used in the [next section for the predictive modeling](#predictive-modeling). The non-grouped object will be easier to work with for the visualizations. -->
<!-- The first thing we can do, is visualize the target % change over time for our data across the different cryptocurrencies. We will use the `ggplot2` package, which is part of the `tidyverse` package that we already imported into the R session earlier, so we don't need to import `ggplot2` to use its functions. -->
<!-- Using `ggplot()`, we can build a chart by first specifying `ggplot(data, aes(x = [variable1], y = [variable2]))`, and then using the correct ***geom*** to decide how to plot the information. We can take the ggplot we just made and add `geom_line()` to show the target variable we calculated in [the previous section](#add-target) over time: -->
<!-- ```{r first_visualization} -->
<!-- ggplot(cryptodata, aes(x=date_time_utc, y=target_percent_change)) + -->
<!--   geom_line() -->
<!-- ``` -->
<!-- This chart however is not exactly useful. Which cryptocurrency is which? There are so many lines that they show up as big black blobs instead, which is not what we want. We can take the same chart, and within the `aes()` argument of `ggplot()` we can simply add the argument `colour=symbol` to add different colors to identify each cryptocurrency: -->
<!-- ```{r first_visualization_by_symbol} -->
<!-- ggplot(cryptodata, aes(x=date_time_utc, y=target_percent_change, colour=symbol)) + -->
<!--   geom_line() -->
<!-- ``` -->
<!-- This is even less useful than before because there are too many different cryptocurrencies. We can use the `gghighlight` package in order to just highlight the top 10 cryptocurrencies by rank instead. When working with ggplots, the whole idea is to build the chart piece by piece, and we will do something similar by simply adding `+ gghighlight([condition])` to the same exact code we just ran above: -->
<!-- ```{r first_visualization_by_symbol_gghighlight} -->
<!-- library(gghighlight) # not part of the tidyverse so needs to be loaded -->
<!-- ggplot(cryptodata, aes(x=date_time_utc, y=target_percent_change, colour=symbol)) + -->
<!--   geom_line() + -->
<!--   gghighlight(rank <= 5) -->
<!-- ``` -->
<!-- Now let's zoom in on things a bit: -->
<!-- ```{r first_visualization_by_symbol_gghighlight_zoom} -->
<!-- library(gghighlight) # not part of the tidyverse so needs to be loaded -->
<!-- ggplot(cryptodata, aes(x=date_time_utc, y=target_percent_change, colour=symbol)) + -->
<!--   geom_line() + -->
<!--   gghighlight(rank <= 5) + -->
<!--   scale_x_datetime(limits = c(Sys.time() - 10*60*60*10, Sys.time()-80000)) + -->
<!--   scale_y_continuous(limits = c(-10,10)) -->
<!-- ``` -->
<!-- Are these trends connected in any way? We can use the package `plotly`[@R-plotly] to wrap the same chart in the function `ggplotly` to make this chart interactive and get more information out of it. Click and drag to move the plot around and scroll within the chart to zoom in and out. -->
<!-- ```{r first_visualization_ggplotly} -->
<!-- library(plotly) -->
<!-- (ggplot(cryptodata, aes(x=date_time_utc, y=target_percent_change, colour=symbol)) + -->
<!--   geom_line() + -->
<!--   gghighlight(rank <= 5) + -->
<!--   scale_x_datetime(limits = c(Sys.time() - 10*60*60*10, Sys.time()-80000)) + -->
<!--   scale_y_continuous(limits = c(-10,10))) %>%  -->
<!--   ggplotly() -->
<!-- ``` -->
<!-- ## Rayshader -->
<!-- We can use the `Rayshader` package to create a 3d representation of a ggplot. We can first make a heatmap of the 24 hour target % change over time and assign it to the object `rayshader_plot`: -->
<!-- ```{r first_visualization_hex} -->
<!-- rayshader_plot <- ggplot(cryptodata, aes(x=date_time_utc, y=target_percent_change)) + geom_hex() -->
<!-- ``` -->
<!-- We can then wrap the result in `plot_gg()`: -->
<!-- ```{r first_rayshader} -->
<!-- library(rayshader) -->
<!-- plot_gg(rayshader_plot) -->
<!-- rgl::rglwidget() -->
<!-- ``` -->
<!-- NEW NOTES MAY -->
<!-- - Here could give more details around flipside FCAS ratings and compare groups to % target, could do it by cv_fold and gganimate -->
<!-- - gghighlight % change over time all cryptos, highlighting top 5 -->
<!-- REMEMBER TO LEVERAGE GGANIMATE AND RAYSHADER FOR THIS SECTION -->
<!-- OLD CODE BELOW -->
<!-- **Summary for discussion:** Having narrowed down the dataset to less but more interesting variables, we should be able to create some relatively interesting visualizations here. Doing so, relationships like the previous 24h % change to the target variable, become *extremely* obvious.  -->
<!-- We will introduce the idea that as a cryptocurrency trader there are limitations based on where you live, and whether the cryptocurrency is large enough to actually be found on an exchange that you can trade on. For example, Binance was by far the largest exchange in the US, but it became illegal for US citizens to trade on Binance in 2019, and people in the United States can now only trade on "Binance US", which offers a smaller selection of cryptocurrencies to trade on. **So,** the observed relationships that seem extremely strong when looking at the market as a whole are actually not nearly as strong when you look at an individual exchange that people in the US could actually trade on. -->
<!-- Therefore the section will end with the same visual exploration from the start of the section, but breaking things down by 4 exchanges, and calculating the % change in the prices using the prices found on those specific exchanges directly instead of the aggregated average reported price. These relationships will be much weaker than the illusion created by looking at the markets as a whole. The 4 exchanges would be KuCoin, HitBTC, BitMart and Bibox; these ones specifically, because I have web scrapers that collect the prices specific to these exchanges only. I could set more up, I just have these ones because I identified these as the best exchanges for me to do trades on using an automated strategy in terms of them working with the tools I am using and having a large variety of cryptocurrencies. -->
<!-- A good approach might be to explore 1 exchange only, and offer additional material around doing the same for the other 3 that people can use as they will. -->
<!-- Here just add just one example for now of one chart going over ggplot2 syntax and general idea (look at what I wrote for tutorials), add a theme to it, turn it into an interactive plot, then use rayshader on it (so probably best to do a hex which looks nice) -->
<!-- ```{r setupVisualization, echo=F, message=FALSE, warning=FALSE} -->
<!-- # setup here -->
<!-- # library(plotly) -->
<!-- # library(ggpubr) -->
<!-- # library(rayshader) -->
<!-- # library(gghighlight) -->
<!-- ``` -->
<!-- Let's take a first look at the data by looking at the price of different cryptocurrencies over time: -->
<!-- ```{r message=FALSE, warning=FALSE} -->
<!-- # library(gghighlight) -->
<!-- # ggplot(cryptodata, aes(x=date, y=price_usd, colour=symbol)) + -->
<!-- #   geom_line() + -->
<!-- #   gghighlight(symbol=='BTC'|symbol=='ETH') -->
<!-- ``` -->
<!-- Bitcoin (BTC) and Bitcoin (ETH) are highlighted using the `gghighlight` [@R-gghighlight] package. -->
<!-- <!-- ***Note for discussion: create custom plotting function or walk through ggplot code?*** -->
<!-- It's hard to tell anything about the data from the previous view because of the differences in the range in prices ($). Let's take the log of the price and make the same chart: -->
<!-- <!-- ```{r message=FALSE, warning=FALSE} -->
<!-- <!-- ggplot(cryptodata, aes(x=date, y=log(price_usd), colour=symbol)) + -->
<!-- <!--   geom_line() + -->
<!-- <!--   gghighlight(symbol=='BTC'|symbol=='ETH'|symbol=='MANA') -->
<!-- <!-- ``` -->
<!-- CREATE CUSTOM FUNCTION TO CREATE THIS PLOT PLOT_price_usd(log_price=TRUE) - OR BETTER TO LEAVE AS IS? -->
<!-- ```{r visualize_target_percent_change, warning=FALSE} -->
<!-- ggplot(cryptodata, aes(x=date, y=target_percent_change, colour=symbol)) + -->
<!--   geom_point() + -->
<!--   ylim(c(-20,20))  + -->
<!--   geom_smooth(method = "loess", colour='blue') + -->
<!--   gghighlight(symbol=='ETH') -->
<!-- ``` -->
<!-- Rayshader example: -->
<!-- ```{r} -->
<!-- plot_gg(ggplot(subset(cryptodata,symbol=='BTC'), aes(x=date, y=fees_daily_mean_usd, colour=fees_daily_median_usd)) + -->
<!--   geom_point() ) -->
<!-- ``` -->
<!-- REMEMBER TO LEVERAGE GGANIMATE AND RAYSHADER FOR THIS SECTION -->
<!-- OLD V2 BELOW: -->
<!-- ### Calendar heatmap -->
<!-- ```{r} -->
<!-- # From https://towardsdatascience.com/time-series-calendar-heatmaps-9f576578fcfe -->
<!-- library(plyr) -->
<!-- library(plotly) -->
<!-- library(tidyquant) -->
<!-- poloniex_btc_calendar <- poloniex_btc -->
<!-- poloniex_btc_calendar$weekday = as.POSIXlt(poloniex_btc_calendar$date)$wday +1 #finding the day no. of the week -->
<!-- poloniex_btc_calendar$weekdayf<-factor(poloniex_btc_calendar$weekday,levels=rev(1:7),labels=rev(c("Mon","Tue","Wed","Thu","Fri","Sat","Sun")),ordered=TRUE) #converting the day no. to factor -->
<!-- poloniex_btc_calendar$monthf<-factor(month(poloniex_btc_calendar$date),levels=as.character(1:12),labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),ordered=TRUE) # finding the month -->
<!-- poloniex_btc_calendar$yearmonth<- factor(as.yearmon(poloniex_btc_calendar$date)) #finding the year and the month from the date. Eg: Nov 2018 -->
<!-- poloniex_btc_calendar$week <- as.numeric(format(poloniex_btc_calendar$date,"%W")) #finding the week of the year for each date -->
<!-- poloniex_btc_calendar<-ddply(poloniex_btc_calendar,.(yearmonth),transform,monthweek=1+week-min(week)) #normalizing the week to start at 1 for every month -->
<!-- poloniex_btc_calendar$year <- substr(poloniex_btc_calendar$date,1,4) -->
<!-- poloniex_btc_calendar <- filter(poloniex_btc_calendar, year > 2016) -->
<!-- price_heatmap <- ggplot(poloniex_btc_calendar, aes(monthweek, weekdayf, fill = poloniex_btc_calendar$price_usd)) + geom_tile(colour = "white") + facet_grid(year(poloniex_btc_calendar$date)~monthf) + scale_fill_gradient(low="red", high="green") + xlab("Week of Month") + ylab("") + ggtitle("Time-Series Calendar Heatmap: BTC Price ($)") + labs(fill = "Price") -->
<!-- #price_heatmap -->
<!-- plot_gg(price_heatmap) -->
<!-- ``` -->
<!-- Does the previous 24h % change affect the outcome of the % change for the next 24 hours? -->
<!-- ```{r targetVsChange, warning=F} -->
<!-- # adjust this to be a heatmap/different look instead -->
<!-- ggplot(poloniex_btc, aes(x=change_percent, y=target_perc_change)) + -->
<!--   geom_point(color='deepskyblue4', size=1.5) + -->
<!--   xlim(c(-20,20)) + -->
<!--   ylim(c(-20,20)) + -->
<!--   stat_cor(label.x = -20, label.y = 20) + -->
<!--   stat_regline_equation(label.x = -20, label.y = 17) + -->
<!--   labs(title='Relationship between previous 24h % change and next 24h % change vs. USD', -->
<!--        x='Previous 24h % Change', y= 'Next 24h % Change (Target)') + -->
<!--   geom_smooth(color = 'lightcoral', method = 'lm') -->
<!-- ``` -->
<!-- Same chart but filtered down to Bitcoin only: -->
<!-- ```{r targetVsChangeBTC, warning=F} -->
<!-- # adjust this to be a heatmap/different look instead -->
<!-- ggplot(filter(investing_dot_com,symbol=='BTC'), aes(x=change_percent, y=target_perc_change)) + -->
<!--   geom_point(color='deepskyblue4', size=1.5) + -->
<!--   xlim(c(-20,20)) + -->
<!--   ylim(c(-20,20)) + -->
<!--   stat_cor(label.x = -20, label.y = 20) + -->
<!--   stat_regline_equation(label.x = -20, label.y = 17) + -->
<!--   labs(title='Relationship between previous 24h % change and next 24h % change vs. USD', -->
<!--        x='Previous 24h % Change', y= 'Next 24h % Change (Target)') + -->
<!--   geom_smooth(color = 'lightcoral', method = 'lm') -->
<!-- ``` -->
<!-- Same chart but filtered down to Bitcoin only: -->
<!-- ```{r targetVsChangeETH, warning=F} -->
<!-- # adjust this to be a heatmap/different look instead -->
<!-- ggplot(filter(investing_dot_com,symbol=='ETH'), aes(x=change_percent, y=target_perc_change)) + -->
<!--   geom_point(color='deepskyblue4', size=1.5) + -->
<!--   xlim(c(-20,20)) + -->
<!--   ylim(c(-20,20)) + -->
<!--   stat_cor(label.x = -20, label.y = 20) + -->
<!--   stat_regline_equation(label.x = -20, label.y = 17) + -->
<!--   labs(title='Relationship between previous 24h % change and next 24h % change vs. USD', -->
<!--        x='Previous 24h % Change', y= 'Next 24h % Change (Target)') + -->
<!--   geom_smooth(color = 'lightcoral', method = 'lm') -->
<!-- ``` -->
<!-- ## Percent Change in Price Vs. USD Over Time -->
<!-- First convert the data to a `tsibble` which is a specialized data type that makes working with timeseries data more effective -->
<!-- ```{r paged.print=TRUE} -->
<!-- library(tsibble) -->
<!-- coin_metrics$date <- as.Date(coin_metrics$date_time_utc) -->
<!-- coin_metrics_tsbl <- as_tsibble(coin_metrics, key = symbol, index = date) -->
<!-- datatable(head(coin_metrics_tsbl,1000)) -->
<!-- ``` -->
<!-- Same deal with the other table: -->
<!-- ```{r} -->
<!-- coin_metrics$date <- as.Date(coin_metrics$date_time_utc) -->
<!-- coin_metrics_tsbl <- as_tsibble(coin_metrics, key = symbol, index = date) -->
<!-- datatable(head(coin_metrics_tsbl,1000)) -->
<!-- ``` -->
<!-- ## Find outliers -->
<!-- ```{r} -->
<!-- library(brolgar) -->
<!-- min_max <- poloniex_btc %>% -->
<!--   ungroup() %>% -->
<!--   filter(near_quantile(target_perc_change, c(0,1), 0.01)) -->
<!-- gg_id_features_red_dots <- -->
<!--   ggplot(poloniex_btc, -->
<!--          aes(x = date_time_utc, -->
<!--              y = target_perc_change)) + -->
<!--   geom_point(data = min_max, -->
<!--              colour = "#c03018", -->
<!--              size = 6) + -->
<!--   geom_point() -->
<!-- gg_id_features_red_dots -->
<!-- ``` -->
<!-- ```{r} -->
<!-- gg_id_features_red_dots_only <- -->
<!-- ggplot(min_max, -->
<!--        aes(x = date_time_utc, -->
<!--            y = target_perc_change, -->
<!--            group = symbol)) + -->
<!--   geom_point(colour = "#c03018", -->
<!--              size = 6) + -->
<!--   geom_point() -->
<!-- gg_id_features_red_dots_only -->
<!-- ``` -->
<!-- ```{r} -->
<!-- library(ggrepel) -->
<!-- gg_id_features_red_dots_only + -->
<!--   geom_label_repel(colour = "#c03018", -->
<!--              aes(label = as.character(date)), -->
<!--              size = 5, -->
<!--              nudge_x = -10) -->
<!-- ``` -->
<!-- ## Correlations -->
<!-- Select numeric variables: -->
<!-- ```{r} -->
<!-- poloniex_btc_correlations <- dplyr::select_if(poloniex_btc, is.numeric) -->
<!-- ``` -->
<!-- Calculate correlation: -->
<!-- ```{r} -->
<!-- poloniex_btc_correlations <- cor(poloniex_btc_correlations, use="complete.obs") -->
<!-- #btc_correlations <- as.data.frame(btc_correlations) -->
<!-- #btc_correlations %>% select(target_perc_change) %>% round(2) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- library(ggcorrplot) -->
<!-- ggcorrplot(poloniex_btc_correlations) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- library(reshape2) -->
<!-- melted_btc_correlations <- melt(poloniex_btc_correlations) -->
<!-- head(melted_btc_correlations) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- melted_btc_correlations <- filter(melted_btc_correlations, Var2=='target_perc_change') -->
<!-- ggplot(data = melted_btc_correlations, aes(x=Var1, y=Var2, fill=value)) + -->
<!--   geom_tile() -->
<!-- ``` -->
<!-- ```{r} -->
<!-- # plot_gg(ggplot(data = melted_btc_correlations, aes(x=Var1, y=Var2, fill=value)) + -->
<!-- #   geom_tile()) -->
<!-- ``` -->
<!-- ```{r} -->
<!-- # Get lower triangle of the correlation matrix -->
<!--   get_lower_tri<-function(cormat){ -->
<!--     cormat[upper.tri(cormat)] <- NA -->
<!--     return(cormat) -->
<!--   } -->
<!--   # Get upper triangle of the correlation matrix -->
<!--   get_upper_tri <- function(cormat){ -->
<!--     cormat[lower.tri(cormat)]<- NA -->
<!--     return(cormat) -->
<!--   } -->
<!-- upper_tri <- get_upper_tri(poloniex_btc_correlations) -->
<!-- upper_tri -->
<!-- # Melt the correlation matrix -->
<!-- library(reshape2) -->
<!-- melted_btc_correlations <- melt(upper_tri, na.rm = TRUE) -->
<!-- melted_btc_correlations <- filter(melted_btc_correlations, Var2=='target_perc_change') -->
<!-- # Heatmap -->
<!-- library(ggplot2) -->
<!-- correlations_plot <- ggplot(data = melted_btc_correlations, aes(Var2, Var1, fill = value))+ -->
<!--  geom_tile(color = "white")+ -->
<!--  scale_fill_gradient2(low = "blue", high = "red", mid = "white", -->
<!--    midpoint = 0, limit = c(-1,1), space = "Lab", -->
<!--    symbol="Pearson\nCorrelation") + -->
<!--   theme_minimal()+ -->
<!--  theme(axis.text.x = element_text(angle = 45, vjust = 1, -->
<!--     size = 12, hjust = 1))+ -->
<!--  coord_fixed() + -->
<!-- geom_text(aes(Var2, Var1, label = round(value,2)), color = "black", size = 4) + -->
<!-- theme( -->
<!--   axis.title.x = element_blank(), -->
<!--   axis.title.y = element_blank(), -->
<!--   panel.grid.major = element_blank(), -->
<!--   panel.border = element_blank(), -->
<!--   panel.background = element_blank(), -->
<!--   axis.ticks = element_blank(), -->
<!--   legend.justification = c(1, 0), -->
<!--   legend.position = c(7, 0.7), -->
<!--   legend.direction = "horizontal")+ -->
<!--   guides(fill = guide_colorbar(barwidth = 7, barheight = 1, -->
<!--                 title.position = "top", title.hjust = 0.5)) -->
<!-- correlations_plot -->
<!-- #plot_gg(correlations_plot) #doesn't show up well in rayshader -->
<!-- ``` -->
<!-- ## Misc Visuals -->
<!-- ```{r coinmetricsBTCdataset} -->
<!-- bitcoin_coin_metrics <- coin_metrics %>% filter(symbol=='BTC') -->
<!-- ``` -->
<!-- ```{r transactionsBTC} -->
<!-- filesymbol_movie = 'btc_active_addresses_rayshader_test_delete.mp4' -->
<!-- plot_gg(ggplot(data = bitcoin_coin_metrics, aes(x=date_time_utc, y=active_addresses)) +  -->
<!--   geom_hex(color='black')+ -->
<!--   scale_fill_viridis_c(option = "C")) -->
<!-- render_highquality() -->
<!-- render_movie(filesymbol = filesymbol_movie, type = "custom",  -->
<!--                 frames = 720,  phi = phivecfull, zoom = zoomvecfull, theta = thetavec) -->
<!-- rgl::rgl.close() -->
<!-- ``` -->
<!-- <video width="600" height="500" controls> -->
<!--   <source src="btc_active_addresses_rayshader_test_delete.mp4" type="video/mp4"> -->
<!-- </video> -->
<!-- ```{r activeAddressesBTC} -->
<!-- bitcoin_coin_metrics$addresses <- bitcoin_coin_metrics$active_addresses -->
<!-- filesymbol_movie = 'btc_active_addresses_rayshader.mp4' -->
<!-- plot_gg(ggplot(data = bitcoin_coin_metrics, aes(x=date_time_utc, y=addresses, color=addresses)) +  -->
<!--   geom_point() ) -->
<!-- render_movie(filesymbol = filesymbol_movie, type = "custom",  -->
<!--                 frames = 720,  phi = phivecfull, zoom = zoomvecfull, theta = thetavec) -->
<!-- rgl::rgl.close() -->
<!-- ``` -->
<!-- <video width="600" height="500" controls> -->
<!--   <source src="btc_active_addresses_rayshader.mp4" type="video/mp4"> -->
<!-- </video> -->
<!-- ## Visualize timeseries financial data -->
<!-- Highcharter -->
<!-- ```{r highcharterPrep} -->
<!-- library(highcharter) -->
<!-- highcharter_investingdotcom <- coin_metrics %>% select(date, symbol, target_perc_change) %>%  resymbol(asset=symbol, returns=target_perc_change) -->
<!-- # Structure needs to be adjusted to work with highcharter -->
<!-- highchart(type = "stock") %>%  -->
<!--   hc_add_series(highcharter_investingdotcom) -->
<!-- #Need to create new object in xts form, see asset_returns_xts: https://www.highcharts.com/blog/tutorials/highcharts-for-r-users/ -->
<!-- ``` -->
<!-- ```{r highcharterVis1} -->
<!-- # Example to replicate with crypto data -->
<!-- library(quantmod) -->
<!-- x <- getSymbols("GOOG", auto.assign = FALSE) -->
<!-- y <- getSymbols("AMZN", auto.assign = FALSE) -->
<!-- z <- getSymbols("MTN", auto.assign = FALSE) -->
<!-- highchart(type = "stock") %>% -->
<!--   hc_add_series(x) %>% -->
<!--   hc_add_series(y) %>%  -->
<!--   hc_add_series(z) -->
<!-- ``` -->
<!-- ## Some more relationships that don't have to do with the target % change:  -->
<!-- ```{r calculateBinaryTarget} -->
<!-- # Create binary target -->
<!-- for (i in 1:nrow(coin_metrics)){ -->
<!--   if (coin_metrics$target_perc_change[i] > 0){ -->
<!--     coin_metrics$target_perc_change[i] <- 1 -->
<!--   } else{ -->
<!--     coin_metrics$target_perc_change[i] <- 0 -->
<!--   } -->
<!-- } -->
<!-- ``` -->
<!-- ## NEW VIZ 02/15 -->
<!-- bitcoin_poloniex -->
<!-- ```{r bitcoin_poloniex_conversions} -->
<!-- bitcoin_poloniex <- as_tibble(bitcoin_poloniex) -->
<!-- bitcoin_poloniex$date <- as.Date(bitcoin_poloniex$date) -->
<!-- bitcoin_poloniex$price_usd <- gsub(',','',bitcoin_poloniex$price_usd) -->
<!-- bitcoin_poloniex$price_usd <- as.numeric(bitcoin_poloniex$price_usd) -->
<!-- ``` -->
<!-- ### Price of BTC over time -->
<!-- ```{r} -->
<!-- ggplot(bitcoin_poloniex, aes(x=date, y=price_usd)) + -->
<!--   geom_line() -->
<!-- ``` -->
<!-- ### Price of BTC vs. S&P500 over time -->
<!-- ### Heatmap of target % change -->
<!-- ```{r} -->
<!-- # From https://towardsdatascience.com/time-series-calendar-heatmaps-9f576578fcfe -->
<!-- library(plyr) -->
<!-- library(plotly) -->
<!-- library(tidyquant) -->
<!-- bitcoin_poloniex$weekday = as.POSIXlt(bitcoin_poloniex$date)$wday #finding the day no. of the week -->
<!-- bitcoin_poloniex$weekdayf<-factor(bitcoin_poloniex$weekday,levels=rev(1:7),labels=rev(c("Mon","Tue","Wed","Thu","Fri","Sat","Sun")),ordered=TRUE) #converting the day no. to factor  -->
<!-- bitcoin_poloniex$monthf<-factor(month(bitcoin_poloniex$date),levels=as.character(1:12),labels=c("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),ordered=TRUE) # finding the month  -->
<!-- bitcoin_poloniex$yearmonth<- factor(as.yearmon(bitcoin_poloniex$date)) #finding the year and the month from the date. Eg: Nov 2018  -->
<!-- bitcoin_poloniex$week <- as.numeric(format(bitcoin_poloniex$date,"%W")) #finding the week of the year for each date  -->
<!-- bitcoin_poloniex<-ddply(bitcoin_poloniex,.(yearmonth),transform,monthweek=1+week-min(week)) #normalizing the week to start at 1 for every month  -->
<!-- target_heatmap <- ggplot(bitcoin_poloniex, aes(monthweek, weekdayf, fill = bitcoin_poloniex$target_perc_change)) + geom_tile(colour = "white") + facet_grid(year(bitcoin_poloniex$date)~monthf) + scale_fill_gradient(low="red", high="green") + xlab("Week of Month") + ylab("") + ggtitle("Time-Series Calendar Heatmap: BTC Price ($)") + labs(fill = "Price")  -->
<!-- target_heatmap -->
<!-- ``` -->
<!-- ### Rayshader version -->
<!-- ```{r rayshaderCalendarHeatmap} -->
<!-- library(rayshader) -->
<!-- plot_gg(price_heatmap, multicore = TRUE) -->
<!-- ``` -->
<!-- ```{r gemoHexRayshader} -->
<!-- plot_gg(ggplot(bitcoin_poloniex, aes(x=date, y=price_usd)) + -->
<!--   geom_hex()) -->
<!-- ``` -->
<!-- ```{r closergl} -->
<!-- rgl::rgl.close() -->
<!-- ``` -->
<!-- ```{r renderRayshaderTestmp4} -->
<!-- filesymbol_movie = 'rayshaderTest.mp4' -->
<!-- phivechalf = 30 + 60 * 1/(1 + exp(seq(-7, 20, length.out = 180)/2)) -->
<!-- phivecfull = c(phivechalf, rev(phivechalf)) -->
<!-- thetavec = -90 + 45 * sin(seq(0,359,length.out = 360) * pi/180) -->
<!-- zoomvec = 0.45 + 0.2 * 1/(1 + exp(seq(-5, 20, length.out = 180))) -->
<!-- zoomvecfull = c(zoomvec, rev(zoomvec)) -->
<!-- plot_gg(ggplot(bitcoin_poloniex, aes(x=date, y=price_usd)) + -->
<!--   geom_hex()) -->
<!-- #Un-comment the following to run -->
<!-- render_movie(filesymbol = filesymbol_movie, type = "custom",  -->
<!--              frames = 360,  phi = phivecfull, zoom = zoomvecfull, theta = thetavec) -->
<!-- rgl::rgl.close() -->
<!-- ``` -->
<!-- <video width="600" height="500" controls> -->
<!--   <source src="rayshaderTest.mp4" type="video/mp4"> -->
<!-- </video> -->
<!-- ```{r gemoHexRayshaderTargetVsPrev} -->
<!-- filesymbol_movie = 'rayshaderHexTest.mp4' -->
<!-- #Same settings as before but half speed -->
<!-- phivechalf = 30 + 60 * 1/(1 + exp(seq(-7, 20, length.out = 360)/2)) -->
<!-- phivecfull = c(phivechalf, rev(phivechalf)) -->
<!-- thetavec = -90 + 45 * sin(seq(0,359,length.out = 720) * pi/360) -->
<!-- zoomvec = 0.45 + 0.2 * 1/(1 + exp(seq(-5, 20, length.out = 360))) -->
<!-- zoomvecfull = c(zoomvec, rev(zoomvec)) -->
<!-- plot_gg(ggplot(bitcoin_poloniex, aes(x=change_percent, y=target_perc_change)) + -->
<!--   geom_hex()+xlim(c(-5,5)) + ylim(c(-5,5)) ) -->
<!-- #Un-comment the following to run -->
<!-- render_movie(filesymbol = filesymbol_movie, type = "custom",  -->
<!--              frames = 720,  phi = phivecfull, zoom = zoomvecfull, theta = thetavec) -->
<!-- rgl::rgl.close() -->
<!-- ``` -->
<!-- <video width="600" height="500" controls> -->
<!--   <source src="rayshaderHexTest.mp4" type="video/mp4"> -->
<!-- </video> -->
<!-- ### Correlations strength -->
<!-- MA lagged features -->
<!-- ### xts objects -->
<!-- ```{r} -->
<!-- library(xts) -->
<!-- bitcoin_poloniex_xts <- xts(bitcoin_poloniex, order.by = bitcoin_poloniex$date_time_utc) -->
<!-- ``` -->
<!-- ### TTR package -->
<!-- Moving Averages -->
<!-- ```{r maCalc} -->
<!-- library(TTR) -->
<!-- ema_10 <- EMA(bitcoin_poloniex_xts[,"price_usd"], n=10) -->
<!-- sma_10 <- SMA(bitcoin_poloniex_xts[,"price_usd"], n=10) -->
<!-- #more ema -->
<!-- ema_5 <- EMA(bitcoin_poloniex_xts[,"price_usd"], n=5) -->
<!-- ema_50 <- EMA(bitcoin_poloniex_xts[,"price_usd"], n=50) -->
<!-- ema_150 <- EMA(bitcoin_poloniex_xts[,"price_usd"], n=150) -->
<!-- #runMean -->
<!-- runmean_10 <- runMean(bitcoin_poloniex_xts[,"price_usd"], n=10) -->
<!-- # WMA -->
<!-- wma_10 <- WMA(as.numeric(bitcoin_poloniex_xts[,"price_usd"]), n=10) -->
<!-- # ZLEMA -->
<!-- zlema_10 <- ZLEMA(as.numeric(bitcoin_poloniex_xts[,"price_usd"]), n=10) -->
<!-- ``` -->
<!-- More indicators -->
<!-- ```{r taIndicators} -->
<!-- # RSI -->
<!-- #rsi_10 <- RSI(as.numeric(bitcoin_poloniex_xts[,"price_usd"]), n=10) -->
<!-- # Momentum -->
<!-- momentum_10 <- momentum(as.numeric(bitcoin_poloniex_xts[,"price_usd"]), n=10) -->
<!-- # TDI -->
<!-- tdi_10 <- TDI(as.numeric(bitcoin_poloniex_xts[,"price_usd"]), n=10) -->
<!-- # TRIX -->
<!-- trix_10 <- TRIX(as.numeric(bitcoin_poloniex_xts[,"price_usd"]), n=10) -->
<!-- # Wilder Sum -->
<!-- #wildersum_10 <- wilderSum(as.numeric(bitcoin_poloniex_xts[,"price_usd"]), n=10) -->
<!-- ``` -->
<!-- ```{r plotXTS} -->
<!-- autoplot(bitcoin_poloniex_xts$price_usd, geom = "point") -->
<!-- ``` -->
<!-- ```{r plotEMA} -->
<!-- autoplot(ema_10) -->
<!-- ``` -->
<!-- ```{r combineEMA} -->
<!-- ema_price_comparison <- cbind(bitcoin_poloniex_xts$price_usd, ema_10) -->
<!-- autoplot(ema_price_comparison) -->
<!-- ``` -->
<!-- ```{r combineEMAnoFacets} -->
<!-- ema_price_comparison <- cbind(bitcoin_poloniex_xts$price_usd, ema_10) -->
<!-- ggplotly(autoplot(ema_price_comparison, facets = F) ) -->
<!-- ``` -->
<!-- ```{r moreEMAplot} -->
<!-- ema_full_plot <- cbind(ema_price_comparison, ema_5, ema_50, ema_150) -->
<!-- ggplotly(autoplot(ema_full_plot, facets = F) ) -->
<!-- ``` -->
<!-- More comparisons -->
<!-- ```{r visualizeTAcomparisons} -->
<!-- ta_comparisons_10 <- cbind(bitcoin_poloniex_xts$price_usd, ema_10, sma_10, runmean_10, momentum_10, tdi_10, trix_10, wma_10, zlema_10) -->
<!-- ggplotly(autoplot(ta_comparisons_10, facets = F) ) -->
<!-- ``` -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-prep.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="predictive-modeling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["CryptoResearchPaper.pdf", "CryptoResearchPaper.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
